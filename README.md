# ОПИСАНИЕ МЕТОДОВ

Данный документ предназначен для описания основных методов, их ключевых слов, используемых в проекте для создания отчётности.

Описание методов разбито на 2 части: 
* определение метода в таблице Excel,
* определение метода в коде.

Формулы должны быть указаны в Excel файле формата xlsx. Параметры, передаваемые методам должны быть перечислены через запятую, без пробелов.

Зачастую в параметры методов передается тип временного диапазона, за который требуется сформировать отчёт. Ниже описаны используемые временные диапазоны:
1. первый месяц отчётного года по отчётный квартал включительно,
2. первый месяц отчетного квартала по последний месяц отчетного квартала,
3. первый месяц предыдущего года по отчетный квартал включительно предыдущего года,
4. первый месяц отчетного квартала предыдущего года по последний месяц отчетного квартала предыдущего года.

# СОДЕРЖАНИЕ

1. Отчёт №1 - Отчёт по отсутствиям
2. Отчёт №2 - Сведения о неполной занятости и движении работников
3. Отчёт №3 - Сведения о численности, заработной плате и движении работников
4. Отчёт №4 - Сведения об инвестициях в нефинансовые активы
5. Отчёт №10 - Сведения о доходах и расходах
6. Отчёт №11 - Сведения о затратах на производство

## Отчёт №1 - Отчёт по отсутствиям

### zpersqty1

Определение метода: `getZpersQty1(ztypeKf: String?, fiscPerMCount: Int): Double`

ztypeKf - тип показателя; fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад). 

Возвращаемое значение: сумма численности персонала `FqrModel01.zpersQty` fiscPerMCount месяцев назад по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 2 параметра:

1. тип показателя;
2. fiscPerMCount.

Пример формулы в Excel: `'=fqr01.zpersqty1(1.1,1)`

### zpersqty2

Определение метода: `getZpersQty2(ztypeKf: String?, fiscPerMCount: Int, bus: List<Int>): Double`

ztypeKf - тип показателя; 
fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад);
bus - вычисляемые балансовые единицы.

Возвращаемое значение: сумма численности персонала `FqrModel01.zpersQty` fiscPerMCount месяцев назад всех балансовых единиц по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 3 параметра:

1. тип показателя;
2. fiscPerMCount;
3. балансовые единицы в виде массива.

Пример формулы в Excel: `'=fqr01.zpersqty2(1.1,1,{3000,3500,4400})`

### zwrkhrs

Определение метода: `getZwrkHrs(ztypeKf: String?, fiscPerMCount: Int): Double`

ztypeKf - тип показателя;
fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад).

Возвращаемое значение: сумма рабочих часов `FqrModel01.zpersQty` fiscPerMCount месяцев назад по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 2 параметра:

1. тип показателя;
2. fiscPerMCount.

Пример формулы в Excel: `'=fqr01.zwrkhrs(7.3,1)`

## Отчёт №2 - Сведения о неполной занятости и движении работников

### period

Определение метода: `getPeriod(): String`

Возвращаемое значение: текущий квартал и год в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращаемое значение: полное наименование организации вычисляемой балансовой единицы `AttrModel.zqtext1`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`

### zqtext4

Определение метода: `getZqtext4(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращаемое значение: адрес организации вычисляемой балансовой единицы  `AttrModel.zqtext4`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext4()`

### zacokpo

Определение метода: `getZacOkpo(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращаемое значение: столбец ОКПО вычисляемой балансовой единицы `AttrModel.zacOkpo`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpo()`

### zpersqty

Определение метода: `getZpersQty(ztypeKf: String): String`

ztypeKf - тип показателя.

Возвращаемое значение: сумма численности персонала `FqrModel02.zpersQty` вычисляемых балансовых единиц по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr02. В формуле Excel передаётся 1 параметр:

1. тип показателя.

Пример формулы в Excel: `'=fqr02.zpersqty(1.1)`

## Отчёт №3 - Сведения о численности, заработной плате и движении работников

### period
Определение метода: `getPeriod(): String`

Возвращаемое значение: текущий квартал и год в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1 (AttrModel)

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица, date - актуальная дата в формате `[год][месяц][день]`

Возвращаемое значение: полное наименование организации вычисляемой балансовой единицы `AttrModel.zqtext1`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`

### zqtext4

Определение метода: `getZqtext4(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращаемое значение: адрес организации вычисляемой балансовой единицы  `AttrModel.zqtext4`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext4()`

### zacokpo

Определение метода: `getZacOkpo(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращаемое значение: столбец ОКПО вычисляемой балансовой единицы `AttrModel.zacOkpo`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpo()`

### zqtext1 (FqrModel03)

Определение метода: `getZqtxext1(): String`

Возвращаемое значение: полное наименование организации вычисляемой балансовой единицы `FqrModel03.zqtext1`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту fqr03. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr03.zqtext1()`

### zacokved

Определение метода: `getZacOkved(): String`

Возвращаемое значение: код ОКВЭД вычисляемой балансовой единицы `FqrModel03OKVED.zacOkved` в зависимости от балансовой единицы, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту fqr03. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr03.zacokved()`

## Отчёт №4 - Сведения об инвестициях в нефинансовые активы

### period
Определение метода: `getPeriod(): String`

Возвращаемое значение: текущий квартал и год в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата в формате `[год][месяц][день]`

Возвращаемое значение: полное наименование организации вычисляемой балансовой единицы `AttrModel.zqtext1`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`


### zqtext2

Определение метода: `getZqtext2(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата в формате `[год][месяц][день]`

Возвращаемое значение: адрес вычисляемой балансовой единицы `AttrModel.zqtext2`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext2()`

### zacokpg

Определение метода: `getZacOkpg(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата в формате `[год][месяц][день]`

Возвращаемое значение: код ОКПО организации вычисляемой балансовой единицы `AttrModel.zacOkpg`, текущая дата должна быть актуальной `AttrModel.dateFrom <= текущая дата >= AttrModel.dateTo`.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpg()`

### zqkf01

Определение метода: `getZqkf01(bu: Int, ztypeKf: String, diapasonType: Int): Double?`

bu - балансовая единица; ztypeKf - тип показателя `FqrModel04.ztypeKf`; diapasonType - временной диапазон.

Финансовый год/период `FqrModel04.fiscPer` входит в `diapasonType`.

Возвращаемое значение: сумма Amount_1 `FqrModel04.zqKf` вычисляемой балансовой единицы, где `FqrModel04.ztypeKf = ztypeKf`, финансовый год/период `FqrModel04.fiscPer` входит в `diapasonType`.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel передаётся 2 параметра:

1. тип показателя ztypeKf,
2. тип временного диапазона.

Пример формулы в Excel: `'=fqr04.zqkf01(3,1)`


### zokved

Определение метода: `getZokVed(bu: Int): String`

bu - балансовая единица.

Возвращаемое значение: код ОКВЭД `FqrModel04OKVED.zokVed` вычисляемой балансовой единицы. Если значений несколько - каждый ОКВЭД отобразится на новой строке.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr04.zokved()`

### zqtext

Определение метода: `getZqText(bu: Int, diapasonType: Int): String`

bu - балансовая единица; diapasonType - временной диапазон.

Возвращаемое значение: наименование 1 `FqrModel04_02.zqText` вычисляемой балансовой единицы, где финансовый год/период `FqrModel04_02.fiscPer` входит в `diapasonType`. Если значений несколько - наименования будут перечислены через запятую.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel передаётся 1 параметр:

1. тип временного диапазона.

Пример формулы в Excel: `'=fqr04.zqtext(2)`

### zacinn

Определение метода: `getZacInn(bu: Int): Double`

bu - балансовая единица.

Возвращаемое значение: код ИНН `FqrModel04_02.zacInn` вычисляемой балансовой единицы.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr04.zacinn()`

### amount

Определение метода: `getZqText(bu: Int, diapasonType: Int): String`

bu - балансовая единица; diapasonType - временной диапазон.

Возвращаемое значение: сумма `FqrModel04_02.amount` вычисляемой балансовой единицы, где финансовый год/период `FqrModel04_02.fiscPer` входит в `diapasonType`.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel передаётся 1 параметр:

1. тип временного диапазона.

Пример формулы в Excel: `'=fqr04.amount(2)`