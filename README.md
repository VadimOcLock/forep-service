# ОПИСАНИЕ МЕТОДОВ

Данный документ предназначен для описания основных методов, их ключевых слов, используемых в проекте для создания отчётности.

Описание методов разбито на 2 части: 
* определение метода в таблице Excel,
* определение метода в коде.

Формулы должны быть указаны в Excel файле формата xlsx. Параметры, передаваемые методам должны быть перечислены через запятую, без пробелов.

Зачастую в параметры методов передается тип временного диапазона, за который требуется сформировать отчёт. Ниже описаны используемые временные диапазоны:
1. первый месяц отчётного года по отчётный квартал включительно,
2. первый месяц отчетного квартала по последний месяц отчетного квартала,
3. первый месяц предыдущего года по отчетный квартал включительно предыдущего года,
4. первый месяц отчетного квартала предыдущего года по последний месяц отчетного квартала предыдущего года.

# СОДЕРЖАНИЕ

1. Отчёт №1 - Отчёт по отсутствиям
2. Отчёт №2 - Сведения о неполной занятости и движении работников
3. Отчёт №3 - Сведения о численности, заработной плате и движении работников
4. Отчёт №4 - Сведения об инвестициях в нефинансовые активы
5. Отчёт №10 - Сведения о доходах и расходах
6. Отчёт №11 - Сведения о затратах на производство

## Отчёт №1 - Отчёт по отсутствиям

### zpersqty1

Определение метода: `getZpersQty1(ztypeKf: String?, fiscPerMCount: Int): Double`

ztypeKf - тип показателя; fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад). 

Возвращает значение суммы численности персонала `FqrModel01.zpersQty` fiscPerMCount месяцев назад по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 2 параметра:

1. тип показателя;
2. fiscPerMCount.

Пример формулы в Excel: `'=fqr01.zpersqty1(1.1,1)`

### zpersqty2

Определение метода: `getZpersQty2(ztypeKf: String?, fiscPerMCount: Int, bus: List<Int>): Double`

ztypeKf - тип показателя; 
fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад);
bus - вычисляемые балансовые единицы.

Возвращает значение суммы численности персонала `FqrModel01.zpersQty` fiscPerMCount месяцев назад всех балансовых единиц по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 3 параметра:

1. тип показателя;
2. fiscPerMCount;
3. балансовые единицы в виде массива.

Пример формулы в Excel: `'=fqr01.zpersqty2(1.1,1,{3000,3500,4400})`

### zwrkhrs

Определение метода: `getZwrkHrs(ztypeKf: String?, fiscPerMCount: Int): Double`

ztypeKf - тип показателя;
fiscPerMCount - количество месяцев, определяющее период построения отчёта (сколько месяцев назад от текущего времени, например, если `fiscPerMCount = 2`, то берётся период 2 месяца назад).

Возвращает значение суммы рабочих часов `FqrModel01.zpersQty` fiscPerMCount месяцев назад по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr01. В формуле Excel передаётся 2 параметра:

1. тип показателя;
2. fiscPerMCount.

Пример формулы в Excel: `'=fqr01.zwrkhrs(7.3,1)`

## Отчёт №2 - Сведения о неполной занятости и движении работников

### period

Определение метода: `getPeriod(): String`

Возвращает значение актуального квартала и года в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращает значение полного наименования организации (балансовой единицы) `AttrModel.zqtext1`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`

### zqtext4

Определение метода: `getZqtext4(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращает значение адреса организации (балансовой единицы) `AttrModel.zqtext4`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext4()`

### zacokpo

Определение метода: `getZacOkpo(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращает значение столбца ОКПО `AttrModel.zacOkpo`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpo()`

### zpersqty

Определение метода: `getZpersQty(ztypeKf: String): String`

ztypeKf - тип показателя.

Возвращает значение суммы численности персонала `FqrModel02.zpersQty` балансовых единиц по указанному типу показателя.

Для использования данного метода необходимо обратиться к объекту fqr02. В формуле Excel передаётся 1 параметр:

1. тип показателя.

Пример формулы в Excel: `'=fqr02.zpersqty(1.1)`

## Отчёт №3 - Сведения о численности, заработной плате и движении работников

### period
Определение метода: `getPeriod(): String`

Возвращает значение актуального квартала и года в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1 (AttrModel)

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица, date - актуальная дата в формате `[год][месяц][день]`

Возвращает значение полного наименования организации (балансовой единицы) `AttrModel.zqtext1`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`

### zqtext4

Определение метода: `getZqtext4(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращает значение адреса организации (балансовой единицы) `AttrModel.zqtext4`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext4()`

### zacokpo

Определение метода: `getZacOkpo(bu: Int, date: Int): String?`

bu - балансовая единица; date - актуальная дата.

Возвращает значение столбца ОКПО `AttrModel.zacOkpo`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpo()`

### zqtext1 (FqrModel03)

Определение метода: `getZqtxext1(): String`

Возвращает значение полного наименования организации (балансовой единицы) `FqrModel03.zqtext1`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту fqr03. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr03.zqtext1()`

### zacokved

Определение метода: `getZacOkved(): String`

Возвращает значение кода ОКВЭД `FqrModel03OKVED.zacOkved` в зависимости от балансовой единицы, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту fqr03. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=fqr03.zacokved()`

## Отчёт №4 - Сведения об инвестициях в нефинансовые активы

### period
Определение метода: `getPeriod(): String`

Возвращает значение актуального квартала и года в следующем формате

`[квартал][год]` Например : `042022`

Значение квартала определяется следующим образом:

01 квартал - 01, 02, 03 месяц

02 квартал - 04, 05, 06 месяц

03 квартал - 07, 08, 09 месяц

04 квартал - 10, 11, 12 месяц

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.period()`

### zqtext1

Определение метода: `getZqtext1(bu: Int, date: Int): String?`

bu - балансовая единица, date - актуальная дата в формате `[год][месяц][день]`

Возвращает значение полного наименования организации (балансовой единицы) `AttrModel.zqtext1`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext1()`


### zqtext2

Определение метода: `getZqtext2(bu: Int, date: Int): String?`

bu - балансовая единица, date - актуальная дата в формате `[год][месяц][день]`

Возвращает адрес балансовой единицы `AttrModel.zqtext2`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zqtext2()`

### zacokpg

Определение метода: `getZacOkpg(bu: Int, date: Int): String?`

bu - балансовая единица, date - актуальная дата в формате `[год][месяц][день]`

Возвращает код ОКПО организации балансовой единицы `AttrModel.zacOkpg`, если актуальная дата входит во временной диапазон действительности.

Для использования данного метода необходимо обратиться к объекту attr. В формуле Excel параметры не передаются.

Пример формулы в Excel: `'=attr.zacokpg()`

### zqkf01

Определение метода: `getZqkf01(bu: Int, ztypeKf: String, diapasonType: Int): Double?`

bu - балансовая единица, ztypeKf - тип показателя `FqrModel04.ztypeKf`, diapasonType - временной диапазон.

Для сравнения временных диапазонов используется поле `FqrModel04.fiscPer`.

Возвращает сумму Amount_1 `FqrModel04.zqKf` всех записей балансовой единицы, где совпадает тип показателя и временной диапазон.

Для использования данного метода необходимо обратиться к объекту fqr04. В формуле Excel первым параметром необходимо передать тип показателя, вторым - тип временного диапазона.

Пример формулы в Excel: `'=fqr04.zqkf01(3,1)`


